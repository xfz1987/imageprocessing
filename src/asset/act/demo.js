define("lib/fft",[],function(){var r=function(a,t){0==arguments.length?(this.real=0,this.imaginary=0):1==arguments.length?(this.real=arguments[0].real,this.imaginary=arguments[0].imaginary):(this.real=a,this.imaginary=t),this.setReal=function(r){this.real=r},this.setImaginary=function(r){this.imaginary=r},this.getReal=function(){return this.real},this.plus=function(a){var t=new r;return t.setReal(this.real+a.real),t.setImaginary(this.imaginary+a.imaginary),t},this.minus=function(a){var t=new r;return t.setReal(this.real-a.real),t.setImaginary(this.imaginary-a.imaginary),t},this.mul=function(a){var t=new r;return t.setReal(this.real*a.real-this.imaginary*a.imaginary),t.setImaginary(this.real*a.imaginary+this.imaginary*a.real),t},this.div=function(a){var t=new r;return t.setReal(this.real/a),t.setImaginary(this.imaginary/a),t},this.norm=function(){return Math.sqrt(this.real*this.real+this.imaginary*this.imaginary)},this.angle=function(){return Math.atan2(this.imaginary,this.real)},this.conjugate=function(){return new r(this.real,this.imaginary*-1)},this.toString=function(){return 0==this.real?0==this.imaginary?"0":this.imaginary+"i":0==this.imaginary?this.real+"":this.imaginary<0?this.real+""+this.imaginary+"j":this.real+"+"+this.imaginary+"j"}},a=function(r){for(var a=[],t=0;t<r.row;t++)for(var n=0;n<r.col;n++)a[t*r.row+n]=r.at(t,n)*Math.pow(-1,t+n);return a},t=function(r,a){for(var t=-9999999999,n=9999999999,o=0;o<a.length;o++)a[o].norm()>t&&(t=a[o].norm()),a[o].norm()<n&&(n=a[o].norm());for(var e=r.data,o=0;o<r.data.length;o+=4)e[o]=e[o+1]=e[o+2]=255*((a[o/4].norm()-n)/(t-n)),e[o+3]=255},n=function(a){var t=a.length;if(1==t)return[a[0]];for(var o=[],e=0;e<t/2;e++)o[e]=a[2*e];for(var i=n(o),l=[],e=0;e<t/2;e++)l[e]=a[2*e+1];for(var f=n(l),u=[],h=new r,c=0;c<t/2;c++){h.real=Math.cos(2*Math.PI*c/t),h.imaginary=Math.sin(-2*Math.PI*c/t);var s=f[c].mul(h);u[c]=i[c].plus(s),u[c+t/2]=i[c].minus(s)}return u},o=function(a,t,n,o,e){var l=[];if(1==o){for(var f=0;f<n;f++)l[f]=new r(a[e+f],0);l=i(l);for(var f=0;f<l.length;f++)t[e+f]=l[f]}else{for(var f=0;f<n;f++)l[f]=new r(a[e+f*o]);l=i(l);for(var f=0;f<l.length;f++)t[e+f*o]=l[f]}},e=function(r,a,t){for(var n=[],e=0;e<t;e++)o(r,n,a,1,e*a);for(var e=0;e<a;e++)o(n,n,t,a,e);return n},i=function(r){for(var a=r.length,t=[],o=0;o<a;o++)t[o]=r[o].conjugate();t=n(t);for(var o=0;o<a;o++)t[o]=t[o].conjugate(),t[o]=t[o].div(a);return t},l=function(a,t,n,o,e){var l=[];if(1==o){for(var f=0;f<n;f++)l[f]=new r(a[e+f]);l=i(l);for(var f=0;f<l.length;f++)t[e+f]=l[f]}else{for(var f=0;f<n;f++)l[f]=new r(a[e+f*o]);l=i(l);for(var f=0;f<l.length;f++)t[e+f*o]=l[f]}},f=function(r,a,t){for(var n=[],o=0;o<t;o++)l(r,n,a,1,o*a);for(var o=0;o<a;o++)l(n,n,t,a,o);return n};return{center:a,scale:t,fft2D:e,ifft2D:f}}),define("lib/matrix",["lib/fft"],function(r){function a(r,a,t,n){this.row=r||0,this.col=a||0,this.channel=4,this.buffer=n||new ArrayBuffer(r*a*this.channel),this.data=new Uint8ClampedArray(this.buffer),t&&this.data.set(t),this.bytes=1,this.type="CV_RGBA",this.at=function(r,t){return this.data[4*a*r+4*t]},this.setValue=function(r,t,n){var o=4*a*r+4*t;this.data[o]=this.data[o+1]=this.data[o+2]=n,this.data[o+3]=255}}function t(r){for(var a=[],t=256;t--;)a[t]=0;for(var n=0;n<r.row;n++)for(var o=0;o<r.col;o++)a[r.at(n,o)]++;return a}function n(r){for(var t=new a(r.row,r.col),n=t.data,o=r.data,e=r.data.length,i=0;i<e;i+=4)n[i]=n[i+1]=n[i+2]=.299*o[i]+.587*o[i+1]+.114*o[i+2],n[i+3]=255;return t}function o(r){for(var t=new a(r.row,r.col),n=0;n<r.row;n++)for(var o=0;o<r.col;o++)t.setValue(n,o,255-r.at(n,o));return t}function e(r){for(var t=r.row/2,n=r.col/2,o=new a(t,n),e=o.data,i=r.data,l=0,f=0;f<t*n*4;f+=4)f%(4*n)||l++,e[f]=e[f+1]=e[f+2]=i[2*f+l*n*8],e[f+3]=255;return o}function i(r){for(var t=2*r.row,n=2*r.col,o=new a(t,n),e=o.data,i=r.data,l=0,f=0;f<t*n*4;f+=4)f%(4*n)||l++,e[f]=e[f+1]=e[f+2]=i[f/2+l*n*2],e[f+3]=255;return o}function l(r,t){for(var n=new a(r.row,r.col),o=0;o<r.row;o++)for(var e=0;e<r.col;e++)n.setValue(o,e,Math.floor(t*(Math.log(1+r.at(o,e))/Math.log(2))));return n}function f(r){for(var n=new a(r.row,r.col),o=r.data.length/4,e=t(r),i=0;i<256;i++)e[i]=e[i]/o;for(var i=1;i<256;i++)e[i]=e[i]+e[i-1];for(var i=0;i<r.row;i++)for(var l=0;l<r.col;l++)n.setValue(i,l,Math.floor(255*e[r.at(i,l)]));return n}function u(r,t){for(var n=new a(r.row,r.col),o=[[t[0],t[1],t[2]],[t[3],t[4],t[5]],[t[6],t[7],t[8]]],e=0,i=0;i<9;i++)e+=t[i];for(var i=1;i<r.row-1;i++)for(var l=1;l<r.col-1;l++){var f=r.at(i-1,l-1)*o[0][0]+r.at(i-1,l)*o[0][1]+r.at(i-1,l+1)*o[0][2],u=r.at(i,l-1)*o[1][0]+r.at(i,l)*o[1][1]+r.at(i,l+1)*o[1][2],h=r.at(i+1,l-1)*o[2][0]+r.at(i+1,l)*o[2][1]+r.at(i+1,l+1)*o[2][2];n.setValue(i,l,(f+u+h)/e)}return n}function h(r){for(var t=new a(r.row,r.col),n=[[1,1,1],[1,-8,1],[1,1,1]],o=1;o<r.row-1;o++)for(var e=1;e<r.col-1;e++){var i=r.at(o-1,e-1)*n[0][0]+r.at(o-1,e)*n[0][1]+r.at(o-1,e+1)*n[0][2],l=r.at(o,e-1)*n[1][0]+r.at(o,e)*n[1][1]+r.at(o,e+1)*n[1][2],f=r.at(o+1,e-1)*n[2][0]+r.at(o+1,e)*n[2][1]+r.at(o+1,e+1)*n[2][2];t.setValue(o,e,i+l+f)}return t}function c(r,t){for(var n=new a(r.row,r.col),o=h(r),e=0;e<r.row;e++)for(var i=0;i<r.col;i++)n.setValue(e,i,t*r.at(e,i)-o.at(e,i));return n}function s(t){var n=new a(t.row,t.col),o=r.center(t),e=r.fft2D(o,t.col,t.row);return r.scale(n,e),l(n,50)}function v(t,n){for(var o=t.row,e=t.col,i=o*e,l=new a(o,e),f=r.center(t),u=r.fft2D(f,e,o),h=0;h<i;h++){var c=h/e,s=h%e,v=Math.exp(-(Math.pow(c-o/2,2)+Math.pow(s-e/2,2))/(2*n));u[h].real=u[h].real*v,u[h].imaginary=u[h].imaginary*v}for(var w=r.ifft2D(u,e,o),h=0;h<o;h++)for(var g=0;g<e;g++)l.setValue(h,g,w[i-1-(h*e+g)].real*i*Math.pow(-1,h+g));return l}function w(t,n){for(var o=t.row,e=t.col,i=o*e,l=new a(o,e),f=r.center(t),u=r.fft2D(f,e,o),h=0;h<i;h++){var c=h/e,s=h%e,v=1-Math.exp(-(Math.pow(c-o/2,2)+Math.pow(s-e/2,2))/(2*n));u[h].real=u[h].real*v,u[h].imaginary=u[h].imaginary*v}for(var w=r.ifft2D(u,e,o),h=0;h<o;h++)for(var g=0;g<e;g++)l.setValue(h,g,w[i-1-(h*e+g)].real*i*Math.pow(-1,h+g));return l}function g(r,n,o){for(var e,i,l=new a(r.row,r.col),f=(t(r),r.row*r.col,0);f<r.row;f++)for(var u=0;u<r.col;u++)e=Math.random(),i=0,e<n?i=255:e>=n&&e<n+o&&(i=1),l.setValue(f,u,i>0?i:r.at(f,u));return l}function m(r,n,o){for(var e=new a(r.row,r.col),i=(t(r),r.row*r.col,Math.sqrt(o)),l=[],f=0;f<256;f++)l[f]=Math.exp(-Math.pow(f-n,2)/(2*o))/(Math.sqrt(2*Math.PI)*i);for(var u,f=0;f<r.row;f++)for(var h=0;h<r.col;h++)u=Math.random(),e.setValue(f,h,u<l[r.at(f,h)]?255*u:r.at(f,h));return e}function d(r){for(var t=new a(r.row,r.col),n=[],o=function(r,a){return r-a},e=1;e<r.row-1;e++)for(var i=1;i<r.col-1;i++)n=[r.at(e-1,i-1),r.at(e-1,i),r.at(e-1,i+1),r.at(e,i-1),r.at(e,i),r.at(e,i+1),r.at(e+1,i-1),r.at(e+1,i),r.at(e+1,i+1)],n.sort(o),t.setValue(e,i,n[4]);return t}function y(r){for(var t=new a(r.row,r.col),n=[[1,1,1,1,1,1,1],[1,1,1,1,1,1,1],[1,1,1,1,1,1,1],[1,1,1,1,1,1,1],[1,1,1,1,1,1,1],[1,1,1,1,1,1,1],[1,1,1,1,1,1,1]],o=n.length,e=(o-1)/2,i=function(r,a){return r-a},l=e;l<r.row-e;l++)for(var f=e;f<r.col-e;f++){for(var u=[],h=0;h<o;h++)for(var c=0;c<o;c++)u.push(r.at(l-e+h,f-e+c)*n[h][c]);u.sort(i),t.setValue(l,f,u[u.length-1])}return t}function M(r,t){for(var n=new a(r.row,r.col),o=[[1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1]],e=o.length,i=(e-1)/2,l=i;l<r.row-i;l++)for(var f=i;f<r.col-i;f++){for(var u=0,h=0;h<e;h++)for(var c=0;c<e;c++)u+=r.at(l-i+h,f-i+c)*o[h][c];n.setValue(l,f,u/(e*e))}return n}function p(r,t){for(var n=new a(r.row,r.col),o=[[1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1]],e=o.length,i=(e-1)/2,l=i;l<r.row-i;l++)for(var f=i;f<r.col-i;f++){for(var u=0,h=0;h<e;h++)for(var c=0;c<e;c++)u+=1/(r.at(l-i+h,f-i+c)*o[h][c]);n.setValue(l,f,e*e/u)}return n}function I(r,t,n){for(var o=new a(r.row,r.col),e=[[1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1]],i=e.length,l=(i-1)/2,f=l;f<r.row-l;f++)for(var u=l;u<r.col-l;u++){for(var h=0,c=0,s=0;s<i;s++)for(var v=0;v<i;v++){var w=r.at(f-l+s,u-l+v)*e[s][v];h+=Math.pow(w,n+1),c+=Math.pow(w,n)}o.setValue(f,u,h/c)}return o}function V(r){for(var t=new a(r.row,r.col),n=r.data,o=t.data,e=0;e<n.length;e+=4)n[e]<10?(o[e]=o[e+1]=255,o[e+2]=0,o[e+3]=255):(o[e]=o[e+1]=o[e+2]=n[e],o[e+3]=255);return t}function D(r){for(var t=new a(r.row,r.col),n=r.data.length/4,o=[],e=[],i=[],l=256;l--;)o[l]=e[l]=i[l]=0;for(var f=r.data,u=t.data,h=0;h<f.length;h+=4)o[f[h]]++,e[f[h+1]]++,i[f[h+2]]++;for(var h=0;h<256;h++)o[h]=o[h]/n,e[h]=e[h]/n,i[h]=i[h]/n;for(var h=1;h<256;h++)o[h]=o[h]+o[h-1],e[h]=e[h]+e[h-1],i[h]=i[h]+i[h-1];for(var h=0;h<f.length;h+=4)u[h]=Math.floor(255*o[f[h]]),u[h+1]=Math.floor(255*e[f[h+1]]),u[h+2]=Math.floor(255*i[f[h+2]]),u[h+3]=255;return t}return a.prototype={getHistogram:t,gray:n,reverseColor:o,scaleDown:e,scaleUp:i,log:l,histogram:f,spatialFilter:u,laplacian:h,unsharp:c,fourier:s,glpfilter:v,ghpfilter:w,sapNoise:g,gsNoise:m,medianFilter:d,maximumFilter:y,ArithmeticMeanFilter:M,harmonicFilter:p,iharmonicFilter:I,pseudoColor:V,colorImgHE:D},a}),requirejs(["lib/matrix"],function(r){function a(){o.drawImage(e,0,0,n.width,n.height);var a=o.getImageData(0,0,n.width,n.height);i=new r(n.height,n.width,a.data),a=null}function t(r){var a=r.col,t=r.row,e=o.createImageData(a,t);e.data.set(r.data),o.putImageData(e,0,0,0,0,n.width,n.height)}var n=document.getElementById("canvas"),o=n.getContext("2d"),e=document.getElementById("timg"),i=null;document.getElementById("grey").onclick=function(){a();var r=i.gray(i);t(r)},document.getElementById("black").onclick=function(){a();var r=i.scaleDown(i);t(r)},document.getElementById("reverse").onclick=function(){a();var r=i.reverseColor(i);t(r)},document.getElementById("blur").onclick=function(){a();var r=i.unsharp(i,3);t(r)}}),define("act/demo",function(){});